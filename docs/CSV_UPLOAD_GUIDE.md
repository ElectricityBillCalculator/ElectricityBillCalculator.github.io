# คู่มือการใช้งานฟีเจอร์อัพโหลด CSV

## ภาพรวม
ฟีเจอร์อัพโหลด CSV ช่วยให้คุณสามารถเพิ่มข้อมูลห้องพักหลายห้องพร้อมกันได้อย่างรวดเร็วและสะดวก โดยการอัพโหลดไฟล์ CSV ที่มีข้อมูลห้องพัก

## วิธีการใช้งาน

### 1. เข้าถึงฟีเจอร์
1. เข้าสู่ระบบในหน้า Home
2. คลิกปุ่ม "อัพโหลด CSV" (สีเขียว) ที่อยู่ข้างปุ่ม "เพิ่มห้องใหม่"

### 2. ดาวน์โหลดเทมเพลต
1. ในหน้าต่าง modal ที่เปิดขึ้น คลิกปุ่ม "ดาวน์โหลดเทมเพลต CSV"
2. ไฟล์ `rooms_template.csv` จะถูกดาวน์โหลด
3. เปิดไฟล์ด้วยโปรแกรม Excel, Google Sheets หรือโปรแกรมแก้ไขข้อความ

### 3. เตรียมข้อมูล CSV

#### คอลัมน์ที่จำเป็น (ต้องมี)
- **room**: เลขห้อง (เช่น 101, 102, 201)
- **name**: ชื่อผู้เช่า (เช่น สมชาย ใจดี)
- **date**: วันที่บันทึก (รูปแบบ DD/MM/YYYY เช่น 25/12/2024)
- **current**: มิเตอร์ไฟปัจจุบัน (ตัวเลข)
- **previous**: มิเตอร์ไฟก่อนหน้า (ตัวเลข)
- **rate**: อัตราค่าไฟต่อหน่วย (ตัวเลข เช่น 4.5)

#### คอลัมน์เพิ่มเติม (ไม่บังคับ)
- **dueDate**: วันครบกำหนดชำระ (รูปแบบ DD/MM/YYYY)
- **waterCurrent**: มิเตอร์น้ำปัจจุบัน (ตัวเลข)
- **waterPrevious**: มิเตอร์น้ำก่อนหน้า (ตัวเลข)
- **waterRate**: อัตราค่าน้ำต่อหน่วย (ตัวเลข)
- **rent**: ค่าเช่า (ตัวเลข)
- **size**: ขนาดห้อง (ข้อความ เช่น "30 ตร.ม.")

### 4. อัพโหลดไฟล์
1. คลิกที่พื้นที่ "คลิกเพื่อเลือกไฟล์ หรือลากไฟล์มาวางที่นี่"
2. เลือกไฟล์ CSV ที่เตรียมไว้ หรือลากไฟล์มาวางในพื้นที่
3. ระบบจะแสดงตัวอย่างข้อมูลและตรวจสอบความถูกต้อง

### 5. ตรวจสอบและอัพโหลด
1. ตรวจสอบข้อมูลในส่วน "ตัวอย่างข้อมูล"
2. ดูข้อผิดพลาดและคำเตือนในส่วน "การตรวจสอบ"
3. หากไม่มีข้อผิดพลาด คลิกปุ่ม "อัพโหลดข้อมูล"
4. รอให้ระบบประมวลผลและแสดงผลลัพธ์

## ตัวอย่างไฟล์ CSV

### ไฟล์เทมเพลต (rooms_template.csv)
```csv
room,name,date,current,previous,rate,dueDate,waterCurrent,waterPrevious,waterRate,rent,size
101,สมชาย ใจดี,25/12/2024,12345,12000,4.5,31/12/2024,1234,1200,15.5,5000,30 ตร.ม.
102,สมหญิง รักดี,25/12/2024,15678,15000,4.5,31/12/2024,1567,1500,15.5,5500,35 ตร.ม.
103,สมศักดิ์ มั่นคง,25/12/2024,18901,18000,4.5,31/12/2024,1890,1800,15.5,6000,40 ตร.ม.
```

### ไฟล์ตัวอย่างเพิ่มเติม (sample_rooms_data.csv)
ไฟล์นี้มีข้อมูลตัวอย่างเพิ่มเติมสำหรับห้อง 201-305

## กฎการตรวจสอบข้อมูล

### ข้อผิดพลาด (ไม่สามารถอัพโหลดได้)
- ไม่มีเลขห้อง
- ไม่มีชื่อผู้เช่า
- ไม่มีวันที่
- มิเตอร์ไฟปัจจุบันเป็นตัวเลขติดลบ
- มิเตอร์ไฟก่อนหน้าเป็นตัวเลขติดลบ
- อัตราค่าไฟไม่ถูกต้อง (≤ 0)
- มิเตอร์ไฟปัจจุบันน้อยกว่าก่อนหน้า

### คำเตือน (สามารถอัพโหลดได้ แต่ควรตรวจสอบ)
- รูปแบบวันที่ไม่ถูกต้อง (ควรเป็น DD/MM/YYYY)
- มิเตอร์น้ำปัจจุบันน้อยกว่าก่อนหน้า
- อัตราค่าน้ำไม่ถูกต้อง

## ข้อควรระวัง

1. **รูปแบบไฟล์**: ต้องเป็นไฟล์ CSV เท่านั้น
2. **การเข้ารหัส**: ไฟล์ต้องใช้การเข้ารหัส UTF-8 เพื่อรองรับภาษาไทย
3. **การคั่นข้อมูล**: ใช้เครื่องหมายจุลภาค (,) เป็นตัวคั่น
4. **หัวข้อ**: บรรทัดแรกต้องมีหัวข้อคอลัมน์
5. **ข้อมูลว่าง**: หากไม่มีข้อมูลในคอลัมน์เพิ่มเติม ให้เว้นว่างไว้

## การแก้ไขปัญหา

### ปัญหาที่พบบ่อย

1. **ไฟล์ไม่สามารถอ่านได้**
   - ตรวจสอบว่าไฟล์เป็น CSV
   - ตรวจสอบการเข้ารหัส UTF-8

2. **ข้อมูลภาษาไทยแสดงผิด**
   - ตรวจสอบการเข้ารหัสไฟล์
   - บันทึกไฟล์ใหม่ในรูปแบบ UTF-8

3. **จำนวนคอลัมน์ไม่ตรงกัน**
   - ตรวจสอบว่าทุกบรรทัดมีจำนวนคอลัมน์เท่ากับหัวข้อ
   - ตรวจสอบเครื่องหมายคั่นข้อมูล

4. **มิเตอร์ไฟไม่ถูกต้อง**
   - ตรวจสอบว่ามิเตอร์ปัจจุบันมากกว่าก่อนหน้า
   - ตรวจสอบว่าเป็นตัวเลขที่ถูกต้อง

## การสนับสนุน

หากพบปัญหาในการใช้งาน กรุณาติดต่อผู้ดูแลระบบหรือตรวจสอบ Console ของเบราว์เซอร์เพื่อดูข้อผิดพลาดที่เกิดขึ้น 